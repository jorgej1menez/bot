const _0x26fff7 = _0x5228; (function (_0x28602a, _0x2e9796) { const _0x3e8372 = _0x5228, _0x1cbeda = _0x28602a(); while (!![]) { try { const _0x10f1ad = -parseInt(_0x3e8372(0x1f6)) / 0x1 + parseInt(_0x3e8372(0x1e7)) / 0x2 * (-parseInt(_0x3e8372(0x204)) / 0x3) + -parseInt(_0x3e8372(0x1f7)) / 0x4 + -parseInt(_0x3e8372(0x214)) / 0x5 * (-parseInt(_0x3e8372(0x219)) / 0x6) + -parseInt(_0x3e8372(0x1f9)) / 0x7 + parseInt(_0x3e8372(0x20f)) / 0x8 + parseInt(_0x3e8372(0x213)) / 0x9 * (parseInt(_0x3e8372(0x205)) / 0xa); if (_0x10f1ad === _0x2e9796) break; else _0x1cbeda['push'](_0x1cbeda['shift']()); } catch (_0x37c364) { _0x1cbeda['push'](_0x1cbeda['shift']()); } } }(_0x6d43, 0x55a34)); import _0x2b66ac from 'vm'; import _0x542b49 from 'https'; import { load } from 'cheerio'; import _0x1a8e1a from '../utils/wait.js'; import _0x50b98d from '../utils/random.js'; function _0x5228(_0x190fac, _0x38c565) { const _0x6d4379 = _0x6d43(); return _0x5228 = function (_0x522898, _0x287596) { _0x522898 = _0x522898 - 0x1e6; let _0x368991 = _0x6d4379[_0x522898]; return _0x368991; }, _0x5228(_0x190fac, _0x38c565); } function _0x6d43() { const _0x594675 = ['cookies', 'savePath', 'create', 'waitForLoad', 'parse', 'askStream', 'includes', 'wrb.fr', '48936rYmbhS', '114710HBThcS', 'replace', 'GetRequestParams', 'lastActive', 'none', 'WaitForLoad', 'ask', 'ParseResponse', 'keep-alive', '],null,', '104024ZQHlNs', 'Add', 'cfb2h', 'responses', '891lXXhVj', '982830uEpHYM', 'get', 'push', 'proxy', 'https://bard.google.com/_/BardChatUi/data/assistant.lamda.BardFrontendService/StreamGenerate', '6qjasnA', 'startsWith', 'split', 'string', 'isArray', 'inMemory', './db.json', 'https://bard.google.com', 'ToArray', 'googleData', 'options', 'default', 'rc_', 'conversations', 'Agent', 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8', '46YqWvTZ', 'forEach', 'en-US,en;q=0.5', 'axios', 'send', 'runInContext', 'FirstOrDefault', 'stringify', 'Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64;\x20rv:109.0)\x20Gecko/20100101\x20Firefox/109.0', 'now', 'gzip,\x20deflate,\x20br', 'getConversationById', 'navigate', 'addConversation', 'window.WIZ_global_data', '25092rrKpUZ', '436172qjupUt', 'Error\x20parsing\x20response:\x20make\x20sure\x20you\x20are\x20using\x20the\x20correct\x20cookie,\x20copy\x20the\x20value\x20of\x20\x22__Secure-1PSID\x22\x20cookie\x20and\x20set\x20it\x20like\x20this:\x20\x0a\x0anew\x20Bard(\x22__Secure-1PSID=<COOKIE_VALUE>\x22)\x0a\x0aAlso\x20using\x20a\x20US\x20proxy\x20is\x20recommended.\x0a\x0aIf\x20this\x20error\x20persists,\x20please\x20open\x20an\x20issue\x20on\x20github.\x0ahttps://github.com/PawanOsman/GoogleBard', '3395805tKraKt', 'data', 'document']; _0x6d43 = function () { return _0x594675; }; return _0x6d43(); } import _0x46bc7f from './app-dbcontext.js'; import _0x28cc68 from 'axios'; class Bard { [_0x26fff7(0x223)];[_0x26fff7(0x1ea)];['db'];[_0x26fff7(0x1fc)] = ''; constructor(_0x598066, _0x536dff) { const _0x4e9ed0 = _0x26fff7; this[_0x4e9ed0(0x223)] = { 'inMemory': _0x536dff?.[_0x4e9ed0(0x21e)] ?? !![], 'savePath': _0x536dff?.[_0x4e9ed0(0x1fd)] ?? _0x4e9ed0(0x21f), 'proxy': _0x536dff?.[_0x4e9ed0(0x217)] ?? undefined }; if (!this[_0x4e9ed0(0x223)]['proxy']) delete this['options'][_0x4e9ed0(0x217)]; this['db'] = new _0x46bc7f(this[_0x4e9ed0(0x223)][_0x4e9ed0(0x1fd)], { 'inMemory': this[_0x4e9ed0(0x223)][_0x4e9ed0(0x21e)] }), this[_0x4e9ed0(0x1fc)] = _0x598066; const _0x289d1e = new _0x542b49[(_0x4e9ed0(0x227))]({ 'rejectUnauthorized': ![] }); let _0x5d6b7d = { 'proxy': this[_0x4e9ed0(0x223)][_0x4e9ed0(0x217)], 'httpsAgent': _0x289d1e, 'headers': { 'User-Agent': _0x4e9ed0(0x1ef), 'Accept': _0x4e9ed0(0x1e6), 'Accept-Language': _0x4e9ed0(0x1e9), 'Accept-Encoding': _0x4e9ed0(0x1f1), 'Connection': _0x4e9ed0(0x20d), 'Upgrade-Insecure-Requests': '1', 'Sec-Fetch-Dest': _0x4e9ed0(0x1fb), 'Sec-Fetch-Mode': _0x4e9ed0(0x1f3), 'Sec-Fetch-Site': _0x4e9ed0(0x209), 'Sec-Fetch-User': '?1', 'TE': 'trailers' } }; if (!_0x5d6b7d[_0x4e9ed0(0x217)]) delete _0x5d6b7d[_0x4e9ed0(0x217)]; this[_0x4e9ed0(0x1ea)] = _0x28cc68[_0x4e9ed0(0x1fe)](_0x5d6b7d); } async[_0x26fff7(0x1ff)]() { const _0x452edf = _0x26fff7; while (this['db'] === null) { await _0x1a8e1a(0x3e8); } await this['db'][_0x452edf(0x20a)](); } [_0x26fff7(0x1f4)](_0x2f4698) { const _0x4f4375 = _0x26fff7; let _0x44ac07 = { 'id': _0x2f4698, 'c': '', 'r': '', 'rc': '', 'lastActive': Date[_0x4f4375(0x1f0)]() }; return this['db'][_0x4f4375(0x226)][_0x4f4375(0x210)](_0x44ac07), _0x44ac07; } [_0x26fff7(0x1f2)](_0x243afc) { const _0x22a1ae = _0x26fff7; if (!_0x243afc) return { 'id': '', 'c': '', 'r': '', 'rc': '', 'lastActive': Date[_0x22a1ae(0x1f0)]() }; let _0x4e0747 = this['db']['conversations'][_0x22a1ae(0x1ed)](_0x493ed2 => _0x493ed2['id'] === _0x243afc); return !_0x4e0747 ? _0x4e0747 = this['addConversation'](_0x243afc) : _0x4e0747[_0x22a1ae(0x208)] = Date[_0x22a1ae(0x1f0)](), _0x4e0747; } ['getAllConversations']() { const _0x5bba90 = _0x26fff7; return this['db']['conversations'][_0x5bba90(0x221)](); } ['resetConversation'](_0x572f65 = _0x26fff7(0x224)) { const _0x39f443 = _0x26fff7; let _0x321a3c = this['db'][_0x39f443(0x226)][_0x39f443(0x1ed)](_0x4e5c45 => _0x4e5c45['id'] === _0x572f65); if (!_0x321a3c) return; _0x321a3c = { 'id': _0x572f65, 'c': '', 'r': '', 'rc': '', 'lastActive': Date[_0x39f443(0x1f0)]() }; } ['ParseResponse'](_0x5ab615) { const _0x3ecd5e = _0x26fff7; let _0x2c0a91 = { 'r': '', 'c': '', 'rc': '', 'responses': [] }; try { let _0x3e4eb4 = _0x2852a0 => { const _0x141abf = _0x5228; if (typeof _0x2852a0 === _0x141abf(0x21c)) { if (_0x2852a0?.[_0x141abf(0x21a)]('c_')) { _0x2c0a91['c'] = _0x2852a0; return; } if (_0x2852a0?.[_0x141abf(0x21a)]('r_')) { _0x2c0a91['r'] = _0x2852a0; return; } if (_0x2852a0?.[_0x141abf(0x21a)](_0x141abf(0x225))) { _0x2c0a91['rc'] = _0x2852a0; return; } _0x2c0a91[_0x141abf(0x212)][_0x141abf(0x216)](_0x2852a0); } Array[_0x141abf(0x21d)](_0x2852a0) && _0x2852a0[_0x141abf(0x1e8)](_0x32a340 => { _0x3e4eb4(_0x32a340); }); }; try { const _0x532a7c = _0x5ab615['split']('\x0a'); for (let _0x36f709 in _0x532a7c) { const _0x41436b = _0x532a7c[_0x36f709]; if (_0x41436b[_0x3ecd5e(0x202)](_0x3ecd5e(0x203))) { let _0x272981 = JSON[_0x3ecd5e(0x200)](_0x41436b), _0x33c0f5 = JSON[_0x3ecd5e(0x200)](_0x272981[0x0][0x2]); _0x33c0f5[_0x3ecd5e(0x1e8)](_0x4cf948 => { _0x3e4eb4(_0x4cf948); }); } } } catch (_0x43e523) { throw new Error(_0x3ecd5e(0x1f8)); } } catch (_0x54b744) { throw new Error('Error\x20parsing\x20response:\x20make\x20sure\x20you\x20are\x20using\x20the\x20correct\x20cookie,\x20copy\x20the\x20value\x20of\x20\x22__Secure-1PSID\x22\x20cookie\x20and\x20set\x20it\x20like\x20this:\x20\x0a\x0anew\x20Bard(\x22__Secure-1PSID=<COOKIE_VALUE>\x22)\x0a\x0aAlso\x20using\x20a\x20US\x20proxy\x20is\x20recommended.\x0a\x0aIf\x20this\x20error\x20persists,\x20please\x20open\x20an\x20issue\x20on\x20github.\x0ahttps://github.com/PawanOsman/GoogleBard'); } return _0x2c0a91; } async[_0x26fff7(0x207)]() { const _0x2237c9 = _0x26fff7; try { const _0x294ce0 = await this[_0x2237c9(0x1ea)][_0x2237c9(0x215)](_0x2237c9(0x220), { 'headers': { 'Cookie': this['cookies'] } }); let _0x523458 = load(_0x294ce0[_0x2237c9(0x1fa)]), _0x16b5ec = _0x523458('script[data-id=_gd]')['html'](); _0x16b5ec = _0x16b5ec[_0x2237c9(0x206)](_0x2237c9(0x1f5), _0x2237c9(0x222)); const _0x5dae76 = { 'googleData': { 'cfb2h': '', 'SNlM0e': '' } }; _0x2b66ac['createContext'](_0x5dae76), _0x2b66ac[_0x2237c9(0x1ec)](_0x16b5ec, _0x5dae76); const _0x688e3e = _0x5dae76[_0x2237c9(0x222)]['SNlM0e'], _0x2959ad = _0x5dae76[_0x2237c9(0x222)][_0x2237c9(0x211)]; return { 'at': _0x688e3e, 'bl': _0x2959ad }; } catch (_0xdf24b9) { throw new Error(_0x2237c9(0x1f8)); } } async[_0x26fff7(0x20b)](_0x201d08, _0x1b0ff9) { const _0x52c4a9 = _0x26fff7; let _0x3511c8 = await this[_0x52c4a9(0x1eb)](_0x201d08, _0x1b0ff9); return _0x3511c8[0x0]; } async[_0x26fff7(0x201)](_0x73c270, _0xce396c, _0x1271a4) { const _0x15a164 = _0x26fff7; let _0x19f556 = await this[_0x15a164(0x1eb)](_0xce396c, _0x1271a4); if (!_0x19f556) return ''; if (!_0x19f556[0x0]) return ''; let _0x37fc59 = _0x19f556[0x0][_0x15a164(0x21b)]('\x20'); for await (let _0x3a01c2 of _0x37fc59) { if (_0x3a01c2 === '') continue; _0x73c270(_0x3a01c2 + '\x20'), await _0x1a8e1a(_0x50b98d(0x19, 0xfa)); } return _0x19f556[0x0]; } async[_0x26fff7(0x1eb)](_0x33b875, _0x28f976) { const _0x34da06 = _0x26fff7; await this['waitForLoad'](); let _0x46a39a = this['getConversationById'](_0x28f976); try { let { at: _0x480869, bl: _0x5f1182 } = await this[_0x34da06(0x207)](); const _0x40557a = await this[_0x34da06(0x1ea)]['post'](_0x34da06(0x218), new URLSearchParams({ 'at': _0x480869, 'f.req': JSON[_0x34da06(0x1ee)]([null, '[[' + JSON[_0x34da06(0x1ee)](_0x33b875) + _0x34da06(0x20e) + JSON[_0x34da06(0x1ee)]([_0x46a39a['c'], _0x46a39a['r'], _0x46a39a['rc']]) + ']']) }), { 'headers': { 'Cookie': this['cookies'] }, 'params': { 'bl': _0x5f1182, 'rt': 'c', '_reqid': '0' } }); let _0x4519a9 = this[_0x34da06(0x20c)](_0x40557a[_0x34da06(0x1fa)]); return _0x46a39a['c'] = _0x4519a9['c'], _0x46a39a['r'] = _0x4519a9['r'], _0x46a39a['rc'] = _0x4519a9['rc'], _0x4519a9[_0x34da06(0x212)]; } catch (_0x561ad8) { console['log'](_0x561ad8['message']); } } } export default Bard;